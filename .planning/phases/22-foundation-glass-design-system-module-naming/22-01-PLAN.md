---
phase: 22-foundation-glass-design-system-module-naming
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/global.css
  - src/layouts/BaseLayout.astro
autonomous: true

must_haves:
  truths:
    - "Gradient background is visible behind all content (purple/blue/pink orbs on dark base)"
    - "CSS variables define all glass parameters (blur, opacity, shadow) in single location"
    - "Tailwind custom utilities glass-panel and glass-panel-elevated are available"
    - "Accessibility media queries disable glass effects when user requests reduced transparency"
    - "@supports fallback provides solid background for unsupported browsers"
  artifacts:
    - path: "src/styles/global.css"
      provides: "CSS variables for glass design system + custom utilities + accessibility queries"
      contains: "--glass-blur"
    - path: "src/layouts/BaseLayout.astro"
      provides: "Gradient background layer"
      contains: "radial-gradient"
  key_links:
    - from: "src/styles/global.css"
      to: "CSS custom properties"
      via: ":root block"
      pattern: ":root.*--glass"
    - from: "src/layouts/BaseLayout.astro"
      to: "gradient background"
      via: "body or container styling"
      pattern: "radial-gradient"
---

<objective>
Establish the CSS foundation for glassmorphism design system: CSS custom properties, Tailwind utilities, vibrant gradient background, and accessibility fallbacks.

Purpose: This is the foundation layer that all glass effects depend on. Glass is invisible without a vibrant background, and CSS variables ensure consistent glass styling across components.

Output: Working gradient background visible on all pages, CSS variables for glass parameters, custom Tailwind utilities ready for use.
</objective>

<execution_context>
@/Users/levoely/.claude/get-shit-done/workflows/execute-plan.md
@/Users/levoely/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/FEATURES_liquid-glass.md

# Key files to modify
@src/styles/global.css
@src/layouts/BaseLayout.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add CSS custom properties and glass utilities to global.css</name>
  <files>src/styles/global.css</files>
  <action>
Add CSS custom properties and glass utilities to the existing global.css file. Insert AFTER the `@import "tailwindcss";` line and BEFORE the `body` rule.

**1. Add CSS custom properties in :root:**
```css
:root {
  /* Glass blur values - responsive */
  --glass-blur-sm: 8px;      /* Mobile / light glass */
  --glass-blur-md: 10px;     /* Default */
  --glass-blur-lg: 16px;     /* Desktop / strong glass */

  /* Glass background opacity */
  --glass-bg-opacity: 0.1;
  --glass-bg-elevated-opacity: 0.15;

  /* Glass border */
  --glass-border-color: rgba(255, 255, 255, 0.18);
  --glass-border-radius: 16px;

  /* Glass shadow */
  --glass-shadow: 0 8px 32px rgba(31, 38, 135, 0.2);
  --glass-shadow-elevated: 0 12px 48px rgba(31, 38, 135, 0.3);

  /* Sidebar-specific glass (darker for navigation) */
  --sidebar-glass-bg: rgba(0, 0, 0, 0.25);
  --sidebar-glass-blur: 10px;
}
```

**2. Add glass utility classes:**
```css
/* Glass panel utilities */
.glass-panel {
  background: rgba(255, 255, 255, var(--glass-bg-opacity));
  backdrop-filter: blur(var(--glass-blur-md));
  -webkit-backdrop-filter: blur(var(--glass-blur-md));
  border: 1px solid var(--glass-border-color);
  border-radius: var(--glass-border-radius);
  box-shadow: var(--glass-shadow);
}

.glass-panel-elevated {
  background: rgba(255, 255, 255, var(--glass-bg-elevated-opacity));
  backdrop-filter: blur(var(--glass-blur-lg));
  -webkit-backdrop-filter: blur(var(--glass-blur-lg));
  border: 1px solid var(--glass-border-color);
  border-radius: var(--glass-border-radius);
  box-shadow: var(--glass-shadow-elevated);
}

/* Sidebar glass - darker variant for navigation */
.glass-sidebar {
  background: var(--sidebar-glass-bg);
  backdrop-filter: blur(var(--sidebar-glass-blur));
  -webkit-backdrop-filter: blur(var(--sidebar-glass-blur));
  border-right: 1px solid rgba(255, 255, 255, 0.1);
}
```

**3. Add @supports fallback for browsers without backdrop-filter:**
```css
/* Fallback for browsers without backdrop-filter support */
@supports not (backdrop-filter: blur(10px)) {
  .glass-panel,
  .glass-panel-elevated {
    background: rgba(30, 30, 50, 0.95);
  }

  .glass-sidebar {
    background: rgba(20, 20, 30, 0.98);
  }
}
```

**4. Add accessibility media queries:**
```css
/* Accessibility: Reduce transparency when requested */
@media (prefers-reduced-transparency: reduce) {
  :root {
    --glass-bg-opacity: 0.95;
    --glass-bg-elevated-opacity: 0.95;
    --sidebar-glass-bg: rgba(20, 20, 30, 0.98);
  }

  .glass-panel,
  .glass-panel-elevated,
  .glass-sidebar {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }
}

/* Accessibility: Reduce motion when requested */
@media (prefers-reduced-motion: reduce) {
  .glass-panel,
  .glass-panel-elevated,
  .glass-sidebar {
    transition: none;
  }
}
```

**5. Add responsive blur reduction for mobile:**
```css
/* Mobile: Reduce blur for performance */
@media (max-width: 1023px) {
  :root {
    --glass-blur-md: 8px;
    --glass-blur-lg: 10px;
    --sidebar-glass-blur: 8px;
  }
}
```

Keep all existing styles (body, prose classes) unchanged. Add new styles in the order specified above.
  </action>
  <verify>
    1. Run `npm run build` - should complete without CSS errors
    2. Check global.css contains `:root` block with `--glass-blur-sm`, `--glass-blur-md`, `--glass-blur-lg`
    3. Check global.css contains `.glass-panel` and `.glass-panel-elevated` classes
    4. Check global.css contains `@supports not (backdrop-filter: blur(10px))` fallback
    5. Check global.css contains `@media (prefers-reduced-transparency: reduce)` query
  </verify>
  <done>
    - CSS variables for glass blur, opacity, border, shadow defined in :root
    - .glass-panel and .glass-panel-elevated utilities available
    - .glass-sidebar utility for navigation available
    - @supports fallback for older browsers
    - prefers-reduced-transparency and prefers-reduced-motion media queries
    - Mobile blur reduction via media query
  </done>
</task>

<task type="auto">
  <name>Task 2: Add vibrant gradient background to BaseLayout</name>
  <files>src/layouts/BaseLayout.astro</files>
  <action>
Modify BaseLayout.astro to add the vibrant gradient background that makes glass effects visible.

**1. Replace the body classes:**

Current:
```html
<body class="bg-gray-900 text-gray-100">
```

Change to:
```html
<body class="text-gray-100 gradient-background">
```

**2. Add the gradient background styles in a `<style>` block before the closing `</head>` tag:**

Insert just before `</head>`:
```html
<style>
  .gradient-background {
    background:
      radial-gradient(circle at 20% 20%, rgba(120, 80, 200, 0.15), transparent 40%),
      radial-gradient(circle at 80% 30%, rgba(80, 120, 200, 0.12), transparent 45%),
      radial-gradient(circle at 40% 80%, rgba(200, 80, 150, 0.1), transparent 40%),
      radial-gradient(circle at 70% 70%, rgba(80, 180, 200, 0.08), transparent 35%),
      #0a0a0f;
    min-height: 100vh;
  }
</style>
```

The gradient uses:
- Purple orb at top-left (20% 20%)
- Blue orb at top-right (80% 30%)
- Pink orb at bottom-left (40% 80%)
- Cyan orb at bottom-right (70% 70%)
- Very dark base (#0a0a0f) instead of pure black

**Important:** Keep all other body content unchanged. The gradient will be visible behind all content, making future glass effects work.

**3. Also update the body rule in global.css to remove conflicting background:**

In src/styles/global.css, change:
```css
body {
  @apply bg-gray-900 text-gray-100;
}
```

To:
```css
body {
  @apply text-gray-100;
}
```

This removes the solid gray background that would override the gradient.
  </action>
  <verify>
    1. Run `npm run dev` and open http://localhost:4321
    2. Visually confirm gradient background is visible (subtle purple/blue/pink tints on dark background)
    3. Gradient should be visible on homepage and lesson pages
    4. Run `npm run build` - should complete without errors
  </verify>
  <done>
    - Vibrant gradient background renders on all pages
    - Purple, blue, pink, cyan orbs visible as subtle tints
    - Dark base (#0a0a0f) provides good contrast
    - No conflicting solid background overrides
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. **CSS Variables test:** Open browser DevTools, inspect any element, check Computed styles - should show CSS custom properties like `--glass-blur-md: 10px`

2. **Utility classes test:** In DevTools console, run:
   ```javascript
   document.body.classList.add('glass-panel');
   ```
   Should see glass effect applied to body (revert after testing)

3. **Gradient test:** Homepage should show subtle color tints in background, not pure black/gray

4. **Build test:** `npm run build` completes successfully

5. **Accessibility test:** In Chrome DevTools > Rendering > Emulate CSS media feature > prefers-reduced-transparency: reduce
   - Glass effects should become nearly opaque
</verification>

<success_criteria>
- [ ] CSS custom properties define all glass parameters in :root
- [ ] .glass-panel and .glass-panel-elevated utilities work (testable via DevTools)
- [ ] .glass-sidebar utility available for navigation
- [ ] Vibrant gradient background visible on all pages
- [ ] @supports fallback provides solid background for unsupported browsers
- [ ] prefers-reduced-transparency media query increases opacity and disables blur
- [ ] prefers-reduced-motion media query disables transitions
- [ ] Mobile media query reduces blur values
- [ ] npm run build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-foundation-glass-design-system-module-naming/22-01-SUMMARY.md`
</output>
