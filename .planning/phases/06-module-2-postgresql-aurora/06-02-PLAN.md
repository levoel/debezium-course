---
phase: 06-module-2-postgresql-aurora
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/content/course/02-module-2/04-aurora-parameter-groups.mdx
  - src/content/course/02-module-2/05-aurora-failover-handling.mdx
autonomous: true

must_haves:
  truths:
    - "Students can configure Aurora DB cluster parameter group for logical replication"
    - "Students know mandatory reboot is required after parameter group change"
    - "Students understand replication slots are NOT synced during Aurora failover (PG <17)"
    - "Students can configure heartbeat for failover detection"
  artifacts:
    - path: "src/content/course/02-module-2/04-aurora-parameter-groups.mdx"
      provides: "Aurora parameter group setup, rds.logical_replication, reboot procedure"
      min_lines: 160
    - path: "src/content/course/02-module-2/05-aurora-failover-handling.mdx"
      provides: "Failover slot behavior, heartbeat configuration, data loss mitigation"
      min_lines: 150
  key_links:
    - from: "04-aurora-parameter-groups.mdx"
      to: "05-aurora-failover-handling.mdx"
      via: "Aurora config enables CDC, failover lesson addresses production resilience"
    - from: "05-aurora-failover-handling.mdx"
      to: "heartbeat.action.query connector config"
      via: "Heartbeat SQL UPDATE detects connector failures and failover gaps"
---

<objective>
Create Aurora-specific CDC configuration lessons covering parameter group setup and failover behavior handling.

Purpose: Aurora has critical differences from standard PostgreSQL that cause production failures if not understood - parameter groups require cluster reboot, replication slots don't survive failover. These lessons prevent common Aurora CDC deployment failures.

Output: Two MDX lessons (04, 05) covering Aurora parameter groups and failover handling with AWS CLI examples, heartbeat configuration, and PostgreSQL 17+ future improvements.
</objective>

<execution_context>
@/Users/levoely/.claude/get-shit-done/workflows/execute-plan.md
@/Users/levoely/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-module-2-postgresql-aurora/06-RESEARCH.md

# Established patterns from Module 1
@src/content/course/01-module-1/01-cdc-fundamentals.mdx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Aurora Parameter Groups lesson</name>
  <files>src/content/course/02-module-2/04-aurora-parameter-groups.mdx</files>
  <action>
Create comprehensive lesson on Aurora CDC configuration (MOD2-04):

**Structure:**
1. Aurora vs standard PostgreSQL - key differences for CDC
2. DB Cluster Parameter Group (NOT instance parameter group) - critical distinction
3. Required parameters: rds.logical_replication=1, max_replication_slots, max_wal_senders
4. Step-by-step AWS Console configuration
5. AWS CLI script for automation
6. MANDATORY reboot requirement - changes don't apply without it
7. Verification queries post-reboot

**Include:**
- Mermaid flowchart: Aurora parameter group configuration workflow (Create -> Modify -> Apply -> Reboot -> Verify)
- AWS CLI script from RESEARCH.md (create-db-cluster-parameter-group, modify, apply, reboot)
- Warning callout: "DB CLUSTER parameter group, not DB instance parameter group"
- Warning callout: "Reboot is MANDATORY - parameters don't take effect otherwise"
- SQL verification: SHOW wal_level; SHOW rds.logical_replication;
- Aurora Serverless v1 limitation note (doesn't support logical replication)

**Aurora-specific gotchas (from RESEARCH.md):**
- Must use DB cluster parameter group
- Requires rds_superuser privileges
- Aurora Serverless v1 NOT supported (use v2 or provisioned)

**Style:**
- Russian explanatory text, English AWS CLI/SQL
- Frontmatter: title, description, order: 4, difficulty: intermediate, duration: 25min, topics: [aurora, aws, parameter-groups, rds-logical-replication]
  </action>
  <verify>
- File exists at src/content/course/02-module-2/04-aurora-parameter-groups.mdx
- `npm run build` passes without errors
- File contains rds.logical_replication parameter
- File has 160+ lines
- File mentions mandatory reboot
  </verify>
  <done>Students can configure Aurora PostgreSQL for Debezium CDC using parameter groups, understand the mandatory reboot requirement, and verify configuration with SQL queries</done>
</task>

<task type="auto">
  <name>Task 2: Create Aurora Failover Handling lesson</name>
  <files>src/content/course/02-module-2/05-aurora-failover-handling.mdx</files>
  <action>
Create comprehensive lesson on Aurora failover behavior with CDC (MOD2-05):

**Structure:**
1. Aurora failover mechanics - writer instance failure, replica promotion
2. CRITICAL: Replication slots NOT synced to replicas (PostgreSQL <17)
3. Data loss scenario: Changes during failover window lost
4. Heartbeat configuration for failover detection
5. Mitigation strategies for current Aurora versions
6. PostgreSQL 17+ failover slots feature (future improvement)

**Include:**
- Mermaid sequence diagram: Aurora failover timeline showing slot loss
- Mermaid diagram: Heartbeat detection flow
- Heartbeat table creation SQL (from RESEARCH.md)
- Connector config with heartbeat.interval.ms and heartbeat.action.query
- SQL: Monitor heartbeat gaps
- Warning callout: "Potential data loss during failover with Aurora PostgreSQL <17"

**Critical teaching points (from RESEARCH.md pitfalls):**
- Slot recreation starts from "latest position" not "last consumed position"
- Heartbeat helps detect gaps but doesn't prevent data loss
- Aurora Global Database as workaround for critical workloads
- PG 17 failover slots will solve this (note Aurora adoption timeline unclear)

**Style:**
- Russian explanatory text, English SQL/JSON config
- Frontmatter: title, description, order: 5, difficulty: advanced, duration: 30min, topics: [aurora-failover, heartbeat, replication-slots, high-availability]
  </action>
  <verify>
- File exists at src/content/course/02-module-2/05-aurora-failover-handling.mdx
- `npm run build` passes without errors
- File contains heartbeat configuration example
- File has 150+ lines
- File mentions PostgreSQL 17 failover slots
  </verify>
  <done>Students understand Aurora failover impact on replication slots, can configure heartbeat for failure detection, and know mitigation strategies for production deployments</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Two lesson files exist (04-aurora-parameter-groups.mdx, 05-aurora-failover-handling.mdx)
2. `npm run build` passes without errors
3. Each file has proper frontmatter with order, difficulty, duration
4. Mermaid diagrams render correctly
5. AWS CLI examples are complete and accurate
6. Heartbeat configuration matches Debezium 2.5.4 syntax
</verification>

<success_criteria>
- 2 MDX files created in src/content/course/02-module-2/
- Total 310+ lines across both files
- 3+ Mermaid diagrams total
- Both files pass content collection validation
- Build completes without errors
- Aurora-specific warnings prominently displayed
</success_criteria>

<output>
After completion, create `.planning/phases/06-module-2-postgresql-aurora/06-02-SUMMARY.md`
</output>
