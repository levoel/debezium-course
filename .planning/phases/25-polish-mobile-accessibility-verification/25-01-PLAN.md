---
phase: 25-polish-mobile-accessibility-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/global.css
autonomous: true

must_haves:
  truths:
    - "Glass blur effects render correctly in Safari 18"
    - "Glass blur effects render correctly in Chrome"
    - "Mobile devices see reduced blur (8px vs 10-16px desktop)"
  artifacts:
    - path: "src/styles/global.css"
      provides: "Safari-compatible glass styling with hardcoded webkit values"
      contains: "-webkit-backdrop-filter: blur(10px)"
  key_links:
    - from: "src/styles/global.css"
      to: "Safari browser"
      via: "hardcoded -webkit-backdrop-filter values"
      pattern: "-webkit-backdrop-filter: blur\\(\\d+px\\)"
---

<objective>
Fix Safari CSS variable bug by adding hardcoded webkit backdrop-filter values.

Purpose: Safari 18 has a confirmed bug where `-webkit-backdrop-filter` does NOT work with CSS variables (e.g., `blur(var(--glass-blur-md))`). Only hardcoded values work. This completely breaks glass effects in Safari, making them invisible.

Output: Updated global.css with hardcoded `-webkit-backdrop-filter` values BEFORE the variable-based `backdrop-filter` in all glass classes, both desktop and mobile media query.
</objective>

<execution_context>
@/Users/levoely/.claude/get-shit-done/workflows/execute-plan.md
@/Users/levoely/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-polish-mobile-accessibility-verification/25-RESEARCH.md

# Critical reference - the file to modify
@src/styles/global.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add hardcoded webkit values for desktop glass classes</name>
  <files>src/styles/global.css</files>
  <action>
Update all glass utility classes (lines 31-71) to include hardcoded `-webkit-backdrop-filter` values BEFORE the variable-based `backdrop-filter`. The webkit line must come FIRST so that modern browsers override it with the variable-based line.

Pattern for each class:
```css
.glass-panel {
  background: rgba(255, 255, 255, var(--glass-bg-opacity));
  /* Safari: hardcoded value (CSS variables don't work in webkit prefix) */
  -webkit-backdrop-filter: blur(10px);
  /* Modern browsers: uses CSS variable */
  backdrop-filter: blur(var(--glass-blur-md));
  border: 1px solid var(--glass-border-color);
  ...
}
```

Apply to these classes with these hardcoded values:
- `.glass-panel`: blur(10px) - matches --glass-blur-md desktop default
- `.glass-panel-elevated`: blur(16px) - matches --glass-blur-lg desktop default
- `.glass-sidebar`: blur(10px) - matches --sidebar-glass-blur desktop default
- `.glass-card`: blur(16px) - matches --glass-blur-lg desktop default

Also update `.prose table` (lines 195-206) with hardcoded webkit value:
- `.prose table`: blur(8px) - matches --glass-blur-content

IMPORTANT: Remove the existing variable-based `-webkit-backdrop-filter` lines since they don't work in Safari.

The order must be:
1. -webkit-backdrop-filter: blur(Npx);  /* Safari hardcoded */
2. backdrop-filter: blur(var(--glass-blur-*));  /* Modern browsers */

This works because modern browsers that support CSS variables will use the second line, while Safari (which doesn't support variables in webkit) will use the first hardcoded line.
  </action>
  <verify>
Run grep to confirm pattern:
```bash
grep -n "webkit-backdrop-filter: blur(" src/styles/global.css
```
Should show hardcoded pixel values (e.g., `blur(10px)`, `blur(16px)`, `blur(8px)`), NOT variable syntax.
  </verify>
  <done>All desktop glass classes have hardcoded -webkit-backdrop-filter values with pixel values, not CSS variables.</done>
</task>

<task type="auto">
  <name>Task 2: Add hardcoded webkit values for mobile media query</name>
  <files>src/styles/global.css</files>
  <action>
Update the mobile media query (lines 119-126) to include separate class rules with hardcoded `-webkit-backdrop-filter` values for mobile Safari.

Current mobile media query only updates CSS variables:
```css
@media (max-width: 1023px) {
  :root {
    --glass-blur-md: 8px;
    --glass-blur-lg: 10px;
    --sidebar-glass-blur: 8px;
  }
}
```

Safari mobile ignores CSS variable updates because webkit prefix already has hardcoded desktop values. Need to add explicit class overrides:

```css
/* Mobile: Reduce blur for performance */
@media (max-width: 1023px) {
  :root {
    --glass-blur-md: 8px;
    --glass-blur-lg: 10px;
    --sidebar-glass-blur: 8px;
  }

  /* Safari mobile: hardcoded reduced values */
  .glass-panel {
    -webkit-backdrop-filter: blur(8px);
  }

  .glass-panel-elevated {
    -webkit-backdrop-filter: blur(10px);
  }

  .glass-sidebar {
    -webkit-backdrop-filter: blur(8px);
  }

  .glass-card {
    -webkit-backdrop-filter: blur(10px);
  }

  .prose table {
    -webkit-backdrop-filter: blur(8px);
  }
}
```

This ensures Safari mobile gets the reduced blur values (8px, 10px) instead of desktop values (10px, 16px).
  </action>
  <verify>
Run grep to confirm mobile webkit overrides exist:
```bash
grep -A 20 "@media (max-width: 1023px)" src/styles/global.css | grep "webkit-backdrop-filter"
```
Should show hardcoded pixel values for each glass class within the mobile media query.
  </verify>
  <done>Mobile media query has hardcoded -webkit-backdrop-filter overrides for all glass classes with reduced blur values (8px/10px).</done>
</task>

<task type="auto">
  <name>Task 3: Verify build and no syntax errors</name>
  <files>src/styles/global.css</files>
  <action>
Run the Astro build to verify CSS syntax is valid and no errors occur:

```bash
npm run build
```

Expected: Build completes successfully with no CSS parsing errors.

Also verify the site renders correctly:
```bash
npm run preview &
sleep 3
curl -s http://localhost:4321/debezium-course/ | grep -c "backdrop-filter"
```

The homepage should load and contain backdrop-filter styles.
  </action>
  <verify>
Build completes with exit code 0. Preview server starts. Homepage loads without errors.
  </verify>
  <done>CSS syntax valid, build passes, site renders correctly with updated glass styles.</done>
</task>

</tasks>

<verification>
1. Build verification:
   - `npm run build` completes without errors
   - No CSS parsing warnings

2. Code verification:
   - All glass classes have hardcoded `-webkit-backdrop-filter: blur(Npx)` (not variables)
   - Mobile media query has webkit overrides for all glass classes
   - Desktop values: 10px (panel, sidebar), 16px (elevated, card), 8px (table)
   - Mobile values: 8px (panel, sidebar, table), 10px (elevated, card)

3. Pattern verification:
   ```bash
   # Should show hardcoded pixel values, not var() syntax
   grep "webkit-backdrop-filter" src/styles/global.css
   ```
</verification>

<success_criteria>
1. All `-webkit-backdrop-filter` declarations use hardcoded pixel values (10px, 16px, 8px), NOT CSS variables
2. Mobile media query includes explicit class overrides with reduced blur values
3. Build passes without CSS errors
4. Glass effects will now render correctly in Safari 18 (verified by cross-browser testing in Plan 03)
</success_criteria>

<output>
After completion, create `.planning/phases/25-polish-mobile-accessibility-verification/25-01-SUMMARY.md`
</output>
