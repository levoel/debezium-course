---
phase: 13-connector-setup-comparison
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/content/course/08-module-8/05-binlog-wal-comparison.mdx
autonomous: true

must_haves:
  truths:
    - "Learner can articulate key differences between MySQL binlog and PostgreSQL WAL"
    - "Learner understands position tracking differences (client-side GTID vs server-side LSN)"
    - "Learner knows which monitoring metrics differ between databases"
    - "Learner can explain why MySQL needs schema history topic while PostgreSQL doesn't"
  artifacts:
    - path: "src/content/course/08-module-8/05-binlog-wal-comparison.mdx"
      provides: "Binlog vs WAL architectural comparison lesson"
      min_lines: 350
      contains: ["replication slot", "schema.history", "gtid", "LSN"]
  key_links:
    - from: "05-binlog-wal-comparison.mdx"
      to: "Module 2 PostgreSQL lessons"
      via: "cross-reference"
      pattern: "module-2"
---

<objective>
Create comparative lesson explaining architectural differences between MySQL binlog and PostgreSQL WAL for CDC, bridging learner's Module 2 PostgreSQL knowledge.

Purpose: MYSQL-05 requires content comparing MySQL binlog vs PostgreSQL WAL (architectural differences, monitoring). This lesson leverages existing PostgreSQL knowledge to deepen MySQL understanding.

Output: `src/content/course/08-module-8/05-binlog-wal-comparison.mdx` with comprehensive comparison
</objective>

<execution_context>
@/Users/levoely/.claude/get-shit-done/workflows/execute-plan.md
@/Users/levoely/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/13-connector-setup-comparison/13-RESEARCH.md
@src/content/course/08-module-8/01-binlog-architecture.mdx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create binlog vs WAL comparison lesson</name>
  <files>src/content/course/08-module-8/05-binlog-wal-comparison.mdx</files>
  <action>
Create lesson file with frontmatter:
- title: "Binlog vs WAL: Архитектурное Сравнение"
- order: 5
- difficulty: intermediate
- estimatedTime: 25 minutes
- topics: mysql, postgresql, binlog, wal, cdc, comparison
- prerequisites: module-8/04-mysql-connector-configuration

Content structure (Russian text, English code):

1. **Introduction** - Why comparison matters
   - Both enable CDC but with fundamentally different approaches
   - Understanding differences prevents PostgreSQL assumptions in MySQL
   - Reference: "Вы уже освоили PostgreSQL CDC в Модуле 2..."

2. **Architecture Comparison Table** (key differences)
   | Aspect | PostgreSQL WAL | MySQL Binlog |
   |--------|----------------|--------------|
   | Purpose | Crash recovery + replication | Replication + point-in-time recovery |
   | Format | Physical (page changes) | Logical (row changes) |
   | CDC Access | Logical decoding (pgoutput/wal2json) | Direct read (already logical) |
   | Position Tracking | Server-side (replication slots) | Client-side (Kafka offsets) |
   | Position Format | LSN (hexadecimal) | GTID or file:offset |
   | DDL Tracking | Implicit in WAL | Requires schema history topic |
   | Failover Handling | Slot survives, LSN continues | GTID relocates automatically |

3. **Position Tracking Deep Dive** (Pitfall 3 from research)
   - PostgreSQL: Server remembers position (replication slot)
     - Advantages: Server guarantees data availability
     - Disadvantages: Slot holds WAL segments, disk growth
   - MySQL: Client remembers position (Kafka Connect offsets)
     - Advantages: No server-side state, cleaner failover
     - Disadvantages: Client must track reliably
   - Mermaid side-by-side sequence diagrams

4. **Schema Evolution Handling**
   - PostgreSQL: Schema embedded in each message (no separate tracking)
   - MySQL: schema.history.internal.kafka.topic required
     - Why: Binlog TABLE_MAP events reference table_id, not full schema
     - Connector reconstructs schema from history on restart
   - Visual: Schema reconstruction flow diagram

5. **Connector Configuration Comparison** (side-by-side JSON)
   - PostgreSQL: plugin.name, slot.name, publication.name
   - MySQL: database.server.id, schema.history.internal.*
   - Common: database.*, table.include.list, topic.prefix
   - Callout: Properties that have NO equivalent in the other database

6. **Monitoring Metrics Comparison** (table)
   | Metric | PostgreSQL | MySQL |
   |--------|------------|-------|
   | Position lag | confirmed_flush_lsn vs current_lsn | gtid_executed vs connector offset |
   | Data retention | pg_stat_replication | binlog_expire_logs_seconds + gtid_purged |
   | Connection health | slot active status | binlog reader thread status |
   | Schema sync | N/A | schema history topic health |

7. **Failover Behavior Comparison**
   - PostgreSQL with replication slots: Slot migrates, LSN continues
   - PostgreSQL without slots: Manual offset management required
   - MySQL with GTID: Automatic relocation to new primary
   - MySQL with file:offset: Complex manual recalculation
   - Recommendation: GTID mode (MySQL) and replication slots (PostgreSQL)

8. **Common Misconceptions** (table format)
   | Misconception | Reality |
   |---------------|---------|
   | "MySQL has replication slots" | No - client tracks position |
   | "PostgreSQL needs schema history topic" | No - schema in each message |
   | "Binlog is physical like WAL" | No - binlog is already logical (ROW format) |
   | "Both use same offset format" | No - LSN (hex) vs GTID (uuid:sequence) |

9. **When to Choose Which** (brief, since course covers both)
   - PostgreSQL: Prefer for new greenfield projects (cleaner logical decoding)
   - MySQL: Often inherited, GTID mode makes CDC reliable
   - Both: Production-viable with proper configuration

10. **Key Takeaways** (10-12 bullet points highlighting differences)

11. **What's Next** (preview schema history deep dive)

Use Mermaid for:
- Position tracking comparison (side-by-side sequence diagrams)
- Schema reconstruction flow (MySQL-specific)
- Failover behavior comparison

Use Callout components:
- type="note" for "If you learned PostgreSQL first..." context
- type="tip" for decision-making guidance
- type="warning" for common misconceptions
  </action>
  <verify>
```bash
# File exists with substantial content
wc -l src/content/course/08-module-8/05-binlog-wal-comparison.mdx
# Expected: 350+ lines

# Contains comparison keywords
grep -c "replication slot" src/content/course/08-module-8/05-binlog-wal-comparison.mdx
grep -c "schema.history" src/content/course/08-module-8/05-binlog-wal-comparison.mdx
grep -c "LSN" src/content/course/08-module-8/05-binlog-wal-comparison.mdx

# Contains comparison tables
grep -c "PostgreSQL" src/content/course/08-module-8/05-binlog-wal-comparison.mdx

# References Module 2
grep -i "module.*2\|модул.*2" src/content/course/08-module-8/05-binlog-wal-comparison.mdx
```
  </verify>
  <done>Lesson covers: architecture differences, position tracking, schema handling, monitoring metrics, failover behavior. Learner understands fundamental MySQL vs PostgreSQL CDC differences.</done>
</task>

</tasks>

<verification>
```bash
# Lesson file exists and has proper frontmatter
head -20 src/content/course/08-module-8/05-binlog-wal-comparison.mdx | grep -E "^(title|order|difficulty):"

# Minimum content depth
wc -l src/content/course/08-module-8/05-binlog-wal-comparison.mdx

# Build passes (Astro can process MDX)
cd /Users/levoely/debezium\ course && npm run build 2>&1 | tail -5
```
</verification>

<success_criteria>
- Lesson file exists at src/content/course/08-module-8/05-binlog-wal-comparison.mdx
- Content is 350+ lines covering all comparison aspects
- Contains comparison tables (PostgreSQL vs MySQL)
- Mentions replication slots (PostgreSQL) and schema.history (MySQL)
- References Module 2 PostgreSQL knowledge
- Build passes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/13-connector-setup-comparison/13-02-SUMMARY.md`
</output>
