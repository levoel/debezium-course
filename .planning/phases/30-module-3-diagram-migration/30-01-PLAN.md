---
phase: 30-module-3-diagram-migration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/diagrams/module3/BinlogArchitectureDiagrams.tsx
  - src/components/diagrams/module3/GtidDiagrams.tsx
  - src/components/diagrams/module3/BinlogRetentionDiagrams.tsx
  - src/components/diagrams/module3/ConnectorConfigDiagrams.tsx
autonomous: true

must_haves:
  truths:
    - "User can see binlog vs WAL architecture comparison diagram with interactive nodes"
    - "User can click nodes to see Russian explanations of binlog concepts"
    - "User can see GTID anatomy and replication diagrams with tooltips"
    - "User can see binlog retention and heartbeat flow diagrams"
  artifacts:
    - path: "src/components/diagrams/module3/BinlogArchitectureDiagrams.tsx"
      provides: "Binlog architecture diagrams (4 diagrams from lesson 01)"
      exports: ["BinlogVsWalDiagram", "RowFormatDiagram", "BinlogEventSequenceDiagram", "BinlogRotationDiagram"]
    - path: "src/components/diagrams/module3/GtidDiagrams.tsx"
      provides: "GTID concepts diagrams (3 diagrams from lesson 02)"
      exports: ["GtidAnatomyDiagram", "GtidReplicationDiagram", "GtidFailoverComparisonDiagram"]
    - path: "src/components/diagrams/module3/BinlogRetentionDiagrams.tsx"
      provides: "Binlog retention and heartbeat diagrams (3 diagrams from lesson 03)"
      exports: ["BinlogRetentionFlowDiagram", "HeartbeatMonitoringDiagram", "RetentionConfigDiagram"]
    - path: "src/components/diagrams/module3/ConnectorConfigDiagrams.tsx"
      provides: "Connector configuration diagram (1 diagram from lesson 04)"
      exports: ["MysqlConnectorDataFlowDiagram"]
  key_links:
    - from: "src/components/diagrams/module3/BinlogArchitectureDiagrams.tsx"
      to: "src/components/diagrams/primitives"
      via: "imports FlowNode, Arrow, DiagramContainer, DiagramTooltip"
      pattern: "import.*from.*primitives"
---

<objective>
Create glass diagram components for Module 3 lessons 01-04, covering binlog architecture, GTID fundamentals, binlog retention/heartbeat, and connector configuration.

Purpose: Replace 11 Mermaid diagrams with interactive glass components that have Russian tooltips explaining MySQL CDC concepts.
Output: 4 component files with 11 exported diagram functions ready for MDX integration.
</objective>

<execution_context>
@/Users/levoely/.claude/get-shit-done/workflows/execute-plan.md
@/Users/levoely/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/30-module-3-diagram-migration/30-RESEARCH.md

# Existing primitives to use
@src/components/diagrams/primitives/FlowNode.tsx
@src/components/diagrams/primitives/Arrow.tsx
@src/components/diagrams/primitives/DiagramContainer.tsx
@src/components/diagrams/primitives/Tooltip.tsx
@src/components/diagrams/primitives/SequenceDiagram.tsx

# Module 2 patterns to follow
@src/components/diagrams/module2/LogicalDecodingDiagrams.tsx

# Source MDX files with Mermaid to convert
@src/content/course/03-module-3/01-binlog-architecture.mdx
@src/content/course/03-module-3/02-gtid-mode-fundamentals.mdx
@src/content/course/03-module-3/03-binlog-retention-heartbeat.mdx
@src/content/course/03-module-3/04-mysql-connector-configuration.mdx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create BinlogArchitectureDiagrams and GtidDiagrams</name>
  <files>
    src/components/diagrams/module3/BinlogArchitectureDiagrams.tsx
    src/components/diagrams/module3/GtidDiagrams.tsx
  </files>
  <action>
Create two component files following the Module 2 pattern (see LogicalDecodingDiagrams.tsx).

**BinlogArchitectureDiagrams.tsx** - 4 diagrams from lesson 01:

1. `BinlogVsWalDiagram`: Side-by-side comparison of PostgreSQL WAL (blue) vs MySQL Binlog (emerald)
   - PostgreSQL side: WAL -> Logical Decoding -> CDC Events
   - MySQL side: Binary Log -> CDC Events (direct)
   - Tooltips explaining physical vs logical format differences

2. `RowFormatDiagram`: ROW format data flow
   - App with UPDATE SQL -> ROW format events showing before/after values
   - Tooltip: "ROW формат записывает фактические изменения строк - до и после модификации"

3. `BinlogEventSequenceDiagram`: Event sequence for INSERT
   - TABLE_MAP_EVENT -> WRITE_ROWS_EVENT -> XID_EVENT
   - Tooltips for each event type explaining their purpose

4. `BinlogRotationDiagram`: Binlog file rotation flow
   - mysql-bin.000001 -> mysql-bin.000002 -> mysql-bin.000003
   - Arrow labels showing rotation triggers (size limit, FLUSH LOGS)

**GtidDiagrams.tsx** - 3 diagrams from lesson 02:

1. `GtidAnatomyDiagram`: GTID structure breakdown
   - source_id (UUID) + transaction_id components
   - Tooltip: "source_id (UUID) уникально идентифицирует сервер MySQL"

2. `GtidReplicationDiagram`: GTID replication flow
   - Primary -> GTID Set -> Replica showing transaction tracking
   - Tooltip explaining global uniqueness

3. `GtidFailoverComparisonDiagram`: Two-column comparison without GTID vs with GTID
   - Left (rose): Position-based failover showing broken position reference
   - Right (emerald): GTID failover showing seamless continuation
   - Tooltips: "Без GTID: позиция mysql-bin.000015:2548 бессмысленна на новом сервере"

Use imports:
```typescript
import { FlowNode } from '../primitives/FlowNode';
import { Arrow } from '../primitives/Arrow';
import { DiagramContainer } from '../primitives/DiagramContainer';
import { DiagramTooltip } from '../primitives/Tooltip';
```

Each diagram must have JSDoc comment describing purpose and export name.
  </action>
  <verify>
Files exist and TypeScript compiles without errors:
```bash
npx tsc --noEmit src/components/diagrams/module3/BinlogArchitectureDiagrams.tsx
npx tsc --noEmit src/components/diagrams/module3/GtidDiagrams.tsx
```
  </verify>
  <done>
BinlogArchitectureDiagrams exports 4 functions, GtidDiagrams exports 3 functions, all with Russian tooltips.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create BinlogRetentionDiagrams and ConnectorConfigDiagrams</name>
  <files>
    src/components/diagrams/module3/BinlogRetentionDiagrams.tsx
    src/components/diagrams/module3/ConnectorConfigDiagrams.tsx
  </files>
  <action>
**BinlogRetentionDiagrams.tsx** - 3 diagrams from lesson 03:

1. `BinlogRetentionFlowDiagram`: Retention lifecycle
   - Write -> Expire threshold -> Purge decision tree
   - Tooltips explaining binlog_expire_logs_seconds behavior

2. `HeartbeatMonitoringDiagram`: Heartbeat event flow (use data flow pattern, NOT sequence)
   - Debezium -> Heartbeat Event -> Kafka -> Lag calculation
   - Tooltip: "Heartbeat события позволяют отслеживать lag даже при отсутствии изменений"

3. `RetentionConfigDiagram`: Parameter configuration
   - binlog_expire_logs_seconds and max_binlog_size nodes
   - Aurora vs self-managed MySQL comparison

**ConnectorConfigDiagrams.tsx** - 1 diagram from lesson 04:

1. `MysqlConnectorDataFlowDiagram`: Complete data pipeline
   - MySQL (binlog) -> Debezium Connector -> Kafka topics
   - Include schema history topic branch
   - Tooltips explaining each component's role

Follow same import pattern and JSDoc comments as Task 1.
  </action>
  <verify>
Files exist and TypeScript compiles without errors:
```bash
npx tsc --noEmit src/components/diagrams/module3/BinlogRetentionDiagrams.tsx
npx tsc --noEmit src/components/diagrams/module3/ConnectorConfigDiagrams.tsx
```
  </verify>
  <done>
BinlogRetentionDiagrams exports 3 functions, ConnectorConfigDiagrams exports 1 function, all with Russian tooltips. Total 11 diagrams for lessons 01-04 complete.
  </done>
</task>

</tasks>

<verification>
After both tasks:
1. All 4 component files exist in src/components/diagrams/module3/
2. TypeScript compilation passes for all files
3. Total of 11 exported diagram functions ready for MDX import
4. All diagrams have Russian tooltips with MySQL-specific explanations
</verification>

<success_criteria>
- 11 diagrams created matching research inventory for lessons 01-04
- Components follow established patterns from Module 2 (LogicalDecodingDiagrams.tsx)
- All tooltips contain contextual Russian explanations
- Code compiles without TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/30-module-3-diagram-migration/30-01-SUMMARY.md`
</output>
