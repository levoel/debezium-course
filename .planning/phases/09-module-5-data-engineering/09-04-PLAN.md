---
phase: 09-module-5-data-engineering
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - src/content/course/05-module-5/07-feature-engineering.mdx
autonomous: true

must_haves:
  truths:
    - "Student can identify CDC events as source for real-time ML features"
    - "Student can compute time-windowed features (rolling aggregations)"
    - "Student can implement customer behavior features from order CDC"
    - "Student can write features to external store using foreachBatch"
    - "Student understands feature store integration options"
  artifacts:
    - path: "src/content/course/05-module-5/07-feature-engineering.mdx"
      provides: "Real-time feature engineering lesson"
      min_lines: 200
      contains: "foreachBatch"
  key_links:
    - from: "07-feature-engineering.mdx"
      to: "Feature store"
      via: "foreachBatch sink"
      pattern: "foreachBatch.*write_to_feature"
---

<objective>
Create feature engineering lesson covering real-time ML feature computation from CDC events.

Purpose: Real-time feature engineering is critical for ML systems that need fresh features. This lesson covers MOD5-07 - enabling students to build feature pipelines that compute customer/product features from CDC events in real-time.

Output: One MDX lesson file covering feature engineering patterns with Russian explanatory text and English code.
</objective>

<execution_context>
@/Users/levoely/.claude/get-shit-done/workflows/execute-plan.md
@/Users/levoely/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-module-5-data-engineering/09-RESEARCH.md

# Reference for lesson structure
@src/content/course/04-module-4/01-smt-overview.mdx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Feature Engineering Lesson</name>
  <files>src/content/course/05-module-5/07-feature-engineering.mdx</files>
  <action>
Create lesson covering MOD5-07 (real-time feature engineering for ML).

**Frontmatter:**
- title: "Real-time Feature Engineering для ML"
- description: "Вычисление ML-признаков из CDC событий в реальном времени"
- order: 7
- difficulty: "advanced"
- estimatedTime: 50
- topics: ["Feature Engineering", "Machine Learning", "Real-Time", "Feature Store", "PySpark"]
- prerequisites: ["module-5/06-etl-elt-patterns"]

**Content structure (Russian explanatory text, English code):**

1. **Зачем real-time features из CDC?** (~200 words)
   - Traditional ML: batch features, stale by hours/days
   - Real-time ML: fresh features for fraud detection, recommendations
   - CDC as feature source: captures every change, no polling
   - Use cases: customer behavior, product metrics, session features
   - Mermaid diagram showing feature pipeline architecture

2. **Типы признаков из CDC событий** (~150 words)
   - **Point-in-time features:** current state (last order, current status)
   - **Aggregated features:** rolling windows (orders last 30 days, total spend)
   - **Behavioral features:** patterns (frequency, recency, velocity)
   - **Derived features:** combinations (is_high_value = total > threshold)

3. **Паттерн: Customer Behavior Features** (~250 words)
   - Example: compute customer features from orders CDC
   - Features: order_count_30d, total_spend_30d, avg_order_value, days_since_last_order
   - Use PySpark window aggregation with watermark
   - Code example from RESEARCH.md Pattern 7 (compute_customer_features)
   - Handle late data with appropriate watermark

4. **Паттерн: Product Metrics Features** (~150 words)
   - Example: compute product features from orders CDC
   - Features: units_sold_7d, revenue_7d, unique_customers
   - Similar window aggregation pattern
   - Code example for product features

5. **Запись в Feature Store** (~200 words)
   - Why feature store: serve features to ML models, versioning, lineage
   - Options: Redis (simple), DynamoDB (AWS), Feast (open source), Tecton (enterprise)
   - Use `foreachBatch()` for writing to external stores
   - Code example from RESEARCH.md Pattern 7 (write_to_feature_store)
   - Note: No official PySpark->Feast connector, use foreachBatch

6. **Feature Store интеграция: Feast** (~150 words)
   - What is Feast: open-source feature store
   - Architecture: online store (Redis), offline store (data lake)
   - Integration pattern: write to online store from streaming, offline from batch
   - Reference RESEARCH.md Open Question 2 about Feast integration

7. **Feature Freshness vs Latency трейдофф** (~100 words)
   - Fresh features require more compute, higher latency
   - Batch features cheaper but stale
   - Hybrid approach: real-time for critical features, batch for stable features
   - Decision framework based on use case

8. **Мониторинг feature pipeline** (~100 words)
   - Track feature computation latency
   - Monitor feature drift (distribution changes)
   - Alert on missing features or computation failures

9. **Лабораторная работа: Customer Features Pipeline** (~100 words)
   - Exercise: build streaming pipeline for customer features
   - Compute: order_count_30d, total_spend_30d, avg_order_value
   - Write to console (simulating feature store)
   - Verify features update as CDC events arrive

Include Mermaid diagrams for feature pipeline architecture.
Reference RESEARCH.md for code patterns and pitfalls.
  </action>
  <verify>
- File exists at src/content/course/05-module-5/07-feature-engineering.mdx
- Frontmatter has all required fields
- Contains feature types explanation (point-in-time, aggregated, behavioral)
- Contains customer behavior features example
- Contains foreachBatch pattern for external writes
- Contains feature store options (Redis, Feast, etc.)
- Contains compute_customer_features code example
- Contains write_to_feature_store pattern
- Mermaid diagram for pipeline architecture
- Russian explanatory text, English code
  </verify>
  <done>Lesson 07-feature-engineering.mdx exists with feature types, computation patterns, feature store integration, and lab exercise</done>
</task>

</tasks>

<verification>
- [ ] Lesson file exists in src/content/course/05-module-5/
- [ ] Lesson order field is 7
- [ ] Prerequisites chain to lesson 06
- [ ] Feature computation code is PySpark compatible
- [ ] foreachBatch pattern demonstrated
- [ ] Feature store options explained
- [ ] Mermaid diagram renders properly
- [ ] Russian language for explanatory text
- [ ] English for code, config, technical terms
</verification>

<success_criteria>
1. Student understands CDC as source for real-time ML features
2. Student can identify feature types (point-in-time, aggregated, behavioral)
3. Student can compute time-windowed customer features
4. Student can write features to external store using foreachBatch
5. Student understands feature store options and integration patterns
</success_criteria>

<output>
After completion, create `.planning/phases/09-module-5-data-engineering/09-04-SUMMARY.md`
</output>
